<div class="local-ctx"></div>
<div class="vertical-center">
    <div class="container">
        <div class="row">
            <div class="col-sm-10 col-md-4 col-md-offset-4">
                <h1 class="text-center login-title">Пожалуйста, введите логин и пароль для продолжения работы с системой</h1>
                <div class="account-wall">
                    <img class="profile-img" src="https://lh5.googleusercontent.com/-b0-k99FZlyE/AAAAAAAAAAI/AAAAAAAAAAA/eu7opA4byxI/photo.jpg?sz=120"
                         alt="">
                    <form class="form-signin">
                        <input name="Ulogin" type="text" class="form-control" placeholder="Логин" required autofocus>
                        <input name="Upassword" type="password" class="form-control" placeholder="Пароль" required>
                        <button class="btn btn-lg btn-primary btn-block" type="submit">
                            Войти</button>
                    </form>
                </div>
                <a href="#" class="text-center new-account">Подать заявку на регистрацию </a>
            </div>
        </div>
    </div>
</div>
<script>
    require(["jquery", "safe", "api", "jquery-block"], function ($, safe, api) {
        $(function () {
            var $form = $('.form-signin');
            $form.submit(function (e) {
                e.preventDefault();
                safe.run(function (cb) {
                    var user = {};
                    user.login = $form.find('input[name="Ulogin"]').val();
                    user.password = $form.find('input[name="Upassword"]').val();
                    $form.block();
                    api.call("core.authenticate", user.login, user.password, cb);
                }, function (err) {
                    $form.unblock();
                    if (!err || (err.data && err.data.subject && err.data.subject == 'AlreadyLogged'))
                        window.location.href = '/index';
                    else
                        appError(err);
                });
                return false;
            });
        });
    });
</script>